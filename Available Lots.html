<!DOCTYPE HTML>
<!--
	Horizons by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html>
	<head>
		<title>Available Lots</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/jquery.dropotron.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-layers.min.js"></script>
		<script src="js/init.js"></script>
		<script src="js/load-navigation.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
		<noscript>
			<link rel="stylesheet" href="css/skel.css" />
			<link rel="stylesheet" href="css/style.css" />
		</noscript>
		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
	<link rel="stylesheet" href="css/common.css" />
	<style>
		/* Page-specific styles */
		body {
			background: url(images/bg18.jpg) no-repeat center center fixed;
			-webkit-background-size: cover;
			-moz-background-size: cover;
			-o-background-size: cover;
			background-size: cover;
		}

		.dropdown-content {
			background-color: rgba(0,240,240,0.9);
		}

		.dropdown-content a:hover {
			background-color: #f1f190;
		}

		img {
			max-width: 100%;
			height: auto;
		}

		.loading {
			text-align: center;
			color: white;
			font-style: italic;
		}
	</style>

<script>
			document.addEventListener('DOMContentLoaded', function() {
				const oldYardDiv = document.getElementById('oldYardLots');
				const upperTerraceDiv = document.getElementById('upperTerraceLots');
				const intervaleTerraceDiv = document.getElementById('intervaleTerraceLots');

				// Show loading message
				oldYardDiv.innerHTML = '<p class="loading">Loading...</p>';
				upperTerraceDiv.innerHTML = '<p class="loading">Loading...</p>';
				intervaleTerraceDiv.innerHTML = '<p class="loading">Loading...</p>';

				// Parse the CSV file
				Papa.parse('data/available_lots.csv', {
					download: true,
					header: true,
					skipEmptyLines: true,
					complete: function(results) {
						let oldYardHtml = 'Old Yard Lots</br>';
						let upperTerraceHtml = 'Upper Terrace Lots</br>';
						let intervaleTerraceHtml = 'Intervale Terrace Lots</br>';

						let oldYardCount = 0;
						let upperTerraceCount = 0;
						let intervaleTerraceCount = 0;

						results.data.forEach(function(lot) {
							if (lot['plot_id'] && lot['lots_available']) {
								const plotId = lot['plot_id'].toUpperCase();
								const lotsText = lot['lots_available'];
								const link = '<a href="cemetery-viewer-v9.html?plot=' + plotId + '">' +
								            plotId + '-' + lotsText + '</a></br>\n';

								// Count lots (count dashes and commas to estimate number of lots)
								const lotCount = (lotsText.match(/[\d]/g) || []).length;

								// Categorize by section
								if (plotId.startsWith('OY')) {
									oldYardHtml += link;
									oldYardCount += lotCount;
								} else if (plotId.startsWith('UT')) {
									upperTerraceHtml += link;
									upperTerraceCount += lotCount;
								} else if (plotId.startsWith('IT')) {
									intervaleTerraceHtml += link;
									intervaleTerraceCount += lotCount;
								}
							}
						});

						oldYardHtml += 'Total Old Yard Lots = ' + oldYardCount + '</br></br>';
						upperTerraceHtml += 'Total Upper Terrace Lots = ' + upperTerraceCount + '</br></br>';
						intervaleTerraceHtml += 'Total Intervale Terrace Lots = ' + intervaleTerraceCount + '</br></br>';

						oldYardDiv.innerHTML = oldYardHtml;
						upperTerraceDiv.innerHTML = upperTerraceHtml;
						intervaleTerraceDiv.innerHTML = intervaleTerraceHtml;

						// Update total
						const totalLots = oldYardCount + upperTerraceCount + intervaleTerraceCount;
						document.getElementById('totalLots').innerHTML = 'Total Available Lots = ' + totalLots;
					},
					error: function(error) {
						oldYardDiv.innerHTML = '<p style="color: red;">Error loading data</p>';
						upperTerraceDiv.innerHTML = '';
						intervaleTerraceDiv.innerHTML = '';
						console.error('Error loading CSV:', error);
					}
				});
			});
		</script>
	</head>
	<body>
	</br></br>
		<div style="background:rgba(60,60,60,0.7)"; class="container">
			<h1 style="text-align: center; color:white; "><a href="#" id="logo">Available Lots</a></h1>
			<!-- Nav -->
			<!-- Navigation placeholder - loaded by load-navigation.js -->
			<div id="nav-placeholder"></div>
						</br></br>
						<div style="font-size: 1.25em; color: white; font-weight: 400;  margin-left:5%; margin-right:5%;">
							<!--Text Div-->
			<p style="text-align: center; font-weight: 500;">Using the Avilable Lots List</p> <!--Section Heading-->	
					<p>What follows is a list of all unsold lots in the Orr's Island Cemetery.  Each lot identified is linked to the applicable plot record page where information on ownership and burials of adjacent lots is displayed. At the top of the record page is a link to a schematic map that shows by section, row and number where each plot is located.</p>
  				
<div style="text-align: center; font-weight: 500;">
<div id="oldYardLots"></div>

New Yard Lots, None</br></br>

Church Yard Lots, None</br></br>

<div id="upperTerraceLots"></div>

<div id="intervaleTerraceLots"></div>

<div id="totalLots"></div>
</div>
				</div>
			</div>
				</br></br></br></br></br></br>
		<!-- Footer -->
			<div id="footer">
				<div class="container">
				</br>
				</br>
				</br>
				</br>
				</br>
				</br>
					<!-- Copyright -->
						<div class="copyright">
						<p>Copyright &copy 2015-2023, Orrs Island Cemetery Association</p>
						<p>Template Design by: <a href="http://templated.co">TEMPLATED</a> </p> 
						</div>
				</div>
			</div>
		</body>
</html>